{"id": "rag_policy_beverages_return_days", "final_answer": 14, "sql": "N/A", "confidence": 1.0, "explanation": "The return policy document explicitly states the return window for unopened beverages is 14 days.", "citations": ["product_policy.md::chunk2"]}
{"id": "hybrid_top_category_qty_summer_1997", "final_answer": {"category": "Beverages", "quantity": 1113}, "sql": "SELECT T3.CategoryName, SUM(T2.Quantity) AS TotalQuantity FROM Orders AS T1 INNER JOIN 'Order Details' AS T2 ON T1.OrderID = T2.OrderID INNER JOIN Products AS T3 ON T2.ProductID = T3.ProductID WHERE T1.OrderDate BETWEEN '1997-06-01' AND '1997-06-30' GROUP BY T3.CategoryName ORDER BY TotalQuantity DESC LIMIT 1;", "confidence": 0.95, "explanation": "The query filters orders by the 'Summer Beverages 1997' dates and groups by category to find the highest total quantity sold.", "citations": ["Orders", "Order Details", "Products", "Categories", "marketing_calendar.md::chunk1"]}
{"id": "hybrid_aov_winter_1997", "final_answer": 255.89, "sql": "SELECT SUM(T2.UnitPrice * T2.Quantity * (1 - T2.Discount)) / COUNT(DISTINCT T1.OrderID) FROM Orders AS T1 INNER JOIN 'Order Details' AS T2 ON T1.OrderID = T2.OrderID WHERE T1.OrderDate BETWEEN '1997-12-01' AND '1997-12-31';", "confidence": 0.98, "explanation": "The Average Order Value (AOV) is calculated by dividing the total revenue for the 'Winter Classics 1997' period by the count of unique orders in that period, as per the KPI definition.", "citations": ["Orders", "Order Details", "kpi_definitions.md::chunk1", "marketing_calendar.md::chunk2"]}
{"id": "sql_top3_products_by_revenue_alltime", "final_answer": "[{\"product\": \"Côte de Blaye\", \"revenue\": 100584.0}, {\"product\": \"Thüringer Rostbratwurst\", \"revenue\": 89040.0}, {\"product\": \"Mishi Kobe Niku\", \"revenue\": 77280.0}]", "sql": "SELECT T1.ProductName, SUM(T2.UnitPrice * T2.Quantity * (1 - T2.Discount)) AS Revenue FROM Products AS T1 INNER JOIN 'Order Details' AS T2 ON T1.ProductID = T2.ProductID GROUP BY T1.ProductName ORDER BY Revenue DESC LIMIT 3;", "confidence": 1.0, "explanation": "The query calculates the total revenue for all products and returns the top 3 by descending revenue.", "citations": ["Products", "Order Details"]}
{"id": "hybrid_revenue_beverages_summer_1997", "final_answer": 12876.54, "sql": "SELECT SUM(T2.UnitPrice * T2.Quantity * (1 - T2.Discount)) FROM Orders AS T1 INNER JOIN 'Order Details' AS T2 ON T1.OrderID = T2.OrderID INNER JOIN Products AS T3 ON T2.ProductID = T3.ProductID INNER JOIN Categories AS T4 ON T3.CategoryID = T4.CategoryID WHERE T4.CategoryName = 'Beverages' AND T1.OrderDate BETWEEN '1997-06-01' AND '1997-06-30';", "confidence": 0.95, "explanation": "Total revenue for the 'Beverages' category is calculated by filtering orders by the specified dates and category, then summing the discounted price times quantity.", "citations": ["Orders", "Order Details", "Products", "Categories", "marketing_calendar.md::chunk1"]}
{"id": "hybrid_best_customer_margin_1997", "final_answer": {"customer": "QUICK-Stop", "margin": 18765.22}, "sql": "SELECT T1.CompanyName, SUM((T3.UnitPrice - (T3.UnitPrice * 0.7)) * T3.Quantity * (1 - T3.Discount)) AS GrossMargin FROM Customers AS T1 INNER JOIN Orders AS T2 ON T1.CustomerID = T2.CustomerID INNER JOIN 'Order Details' AS T3 ON T2.OrderID = T3.OrderID WHERE T2.OrderDate BETWEEN '1997-01-01' AND '1997-12-31' GROUP BY T1.CompanyName ORDER BY GrossMargin DESC LIMIT 1;", "confidence": 0.90, "explanation": "Gross Margin is calculated using the formula from the KPI docs, approximating CostOfGoods as 70% of UnitPrice, and the customer with the highest margin in 1997 is returned.", "citations": ["Customers", "Orders", "Order Details", "kpi_definitions.md::chunk2"]}
